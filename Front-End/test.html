<!DOCTYPE html>
<html lang="en">
<head>
    <title>Directions with Options - Bing Maps Samples</title>
    <!-- Add your meta tags and CSS styles as needed -->

    <script>
        var map, directionsManager;

        function GetMap() {
            map = new Microsoft.Maps.Map('#myMap', {});

            Microsoft.Maps.loadModule('Microsoft.Maps.Directions', function () {
                directionsManager = new Microsoft.Maps.Directions.DirectionsManager(map);

                const coordinates = [
                    { latitude: 6.6775959, longitude: 79.92034269999999 }, // Galgamuwa
                    { latitude: 6.9270786, longitude: 79.861243 },   // Colombo
                ];

                for (const coordinate of coordinates) {
                    directionsManager.addWaypoint(new Microsoft.Maps.Directions.Waypoint({
                        location: new Microsoft.Maps.Location(coordinate.latitude, coordinate.longitude)
                    }));
                }

                // Set request options to calculate directions in kilometers and avoid highways.
                directionsManager.setRequestOptions({
                    distanceUnit: Microsoft.Maps.Directions.DistanceUnit.km,
                    routeAvoidance: [Microsoft.Maps.Directions.RouteAvoidance.avoidLimitedAccessHighway]
                });

                // Customize the route line and waypoint titles as needed.

                // Calculate directions.
                directionsManager.calculateDirections({
                    success: function (result) {
                        if (result && result.routeSummary) {
                            const distanceInKm = result.routeSummary.distance;
                            console.log('Total Distance (km):', distanceInKm);
                        }
                    }
                });
            });
        }
    </script>
</head>
<body>
<div id="myMap" style="position: relative; width: 100%; min-width: 290px; height: 600px; background-color: gray;"></div>

<script>
    (async () => {
        let script = document.createElement("script");
        script.setAttribute("src", `https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=AhTs1NKD6MM19FxIHxv3kseOeji1BrzSQfcutMcPm1xxa5delVftdkNjkOQRkZ0O`);
        document.body.appendChild(script);
    })();
</script>
</body>
</html>
